<link rel="import" href="../bower_components/polymer/polymer.html">

<polymer-element name="my-video">
  <template>
	<table cellpadding="0" cellspacing="0" style="width: 100%">
		<tr>
			<td width="50%"><video layout flex autoplay
					src="{{videosrc}}" width="100%" /></td>
			<td width="50%"><video layout flex autoplay
					src="{{videosrc}}" width="100%" /></td>
		</tr>
	</table>
</template>
  <script>
			Polymer({
				videosrc : null,
				videosrcChanged : function() {
					console.log("videosrcChanged: " + this.videosrc);
				},
				created : function() {
					//...
					console.log("my-menu created!");
				},
				ready : function() {
					//...
					console.log("my-menu ready!");

					navigator.getUserMedia = navigator.getUserMedia
							|| navigator.webkitGetUserMedia
							|| navigator.mozGetUserMedia
							|| navigator.msGetUserMedia;

					var errorCallback = function(e) {
						console.log('Reeeejected!', e);
					};

					var thiss = this;

					MediaStreamTrack.getSources(function(sourceInfos) {
						var audioSource = null;
						var videoSource = null;
						
						for (var i = 0; i != sourceInfos.length; ++i) {
							var sourceInfo = sourceInfos[i];
							if (sourceInfo.kind === 'audio') {
								console.log(sourceInfo.id, sourceInfo.label
										|| 'microphone');

								audioSource = sourceInfo.id;
							} else if (sourceInfo.kind === 'video') {
								console.log(sourceInfo.id, sourceInfo.label
										|| 'camera');

								videoSource = sourceInfo.id;
							} else {
								console.log('Some other kind of source: ',
										sourceInfo);
							}
						}

						// Not showing vendor prefixes.
						navigator.getUserMedia({
							video : {
							      optional: [{sourceId: videoSource}]
						    },
							audio : false
						}, function(localMediaStream) {
							thiss.videosrc = window.URL
									.createObjectURL(localMediaStream);

							// Note: onloadedmetadata doesn't fire in Chrome when using it with getUserMedia.
							// See crbug.com/110938.
							/*thiss.$.videoid.onloadedmetadata = function(e) {
								// Ready to go. Do some stuff.
								console.log('onloadedmetadata!');
							};*/
						}, errorCallback);
					});
				}
			});
		</script>
</polymer-element>      